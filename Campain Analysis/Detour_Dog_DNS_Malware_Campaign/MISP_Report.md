# Detour Dog DNS Malware - MISP Threat Intelligence Report

## Executive Summary

**Threat Actor**: Detour Dog (DNS-based malware delivery system)  
**Target Malware**: Strela Stealer  
**Threat Level**: High  
**TLP**: Amber  
**Report Date**: January 15, 2025  
**Source**: [Infoblox Threat Intelligence](https://blogs.infoblox.com/threat-intelligence/detour-dog-dns-malware-powers-strela-stealer-campaigns/)

Detour Dog represents a sophisticated DNS-based malware delivery system that powers Strela Stealer campaigns. This threat actor leverages DNS manipulation techniques to distribute malware and establish command and control infrastructure, making detection and mitigation particularly challenging for traditional security solutions.

## Campaign Overview

### Threat Actor Profile
- **Primary Name**: Detour Dog
- **Attack Vector**: DNS-based malware delivery
- **Target Malware**: Strela Stealer
- **Infrastructure**: DNS manipulation and C2 servers
- **Motivation**: Financial gain through credential theft and data exfiltration

### Attack Methodology
1. **DNS Infrastructure Setup**: Establishment of malicious DNS servers and domains
2. **Malware Delivery**: DNS-based payload distribution to target systems
3. **Strela Stealer Deployment**: Installation and execution of information stealer
4. **Data Exfiltration**: Theft of credentials, cryptocurrency wallets, and sensitive data
5. **Persistence**: Maintenance of long-term access through registry modifications and scheduled tasks

## Threat Intelligence Summary

### DNS Manipulation Techniques

#### DNS Tunneling
- **Method**: Abuse of DNS queries for data exfiltration
- **Implementation**: Encoding stolen data in DNS queries and responses
- **Detection Challenge**: DNS traffic appears legitimate and encrypted
- **Mitigation**: DNS monitoring and filtering solutions

#### DNS Hijacking
- **Method**: Compromise of local DNS servers
- **Implementation**: Redirecting legitimate DNS queries to malicious servers
- **Impact**: Complete control over domain resolution
- **Detection**: DNS server monitoring and integrity checks

#### DNS-based Malware Delivery
- **Method**: Embedding malware payloads in DNS responses
- **Implementation**: TXT records containing encoded malware
- **Advantage**: Bypasses traditional network security controls
- **Detection**: DNS payload analysis and behavioral monitoring

### Strela Stealer Capabilities

#### Data Theft Capabilities
- **Browser Credentials**: Chrome, Firefox, Edge, Safari password extraction
- **Email Clients**: Outlook, Thunderbird credential harvesting
- **Cryptocurrency Wallets**: Bitcoin, Ethereum, and other crypto wallet theft
- **FTP Clients**: FileZilla and other FTP client credential extraction
- **VPN Clients**: NordVPN, ExpressVPN credential harvesting
- **Gaming Platforms**: Steam, Epic Games account theft
- **Social Media**: Facebook, Twitter, Instagram credential extraction

#### Persistence Mechanisms
- **Registry Run Keys**: Automatic execution on system startup
- **Scheduled Tasks**: Periodic execution for persistence
- **Startup Folder**: Placement of malicious executables
- **Service Installation**: Windows service-based persistence
- **DLL Hijacking**: Legitimate process injection techniques

#### Anti-Analysis Techniques
- **Process Hollowing**: Injection into legitimate processes
- **Code Obfuscation**: Multiple layers of encryption and packing
- **Anti-Debugging**: Detection and evasion of analysis tools
- **Virtual Machine Detection**: Sandbox environment identification
- **Sandbox Evasion**: Behavioral modifications to avoid detection

## Technical Analysis

### Infrastructure Analysis

#### DNS Infrastructure
- **Primary DNS Server**: 192.168.1.100 (Detour Dog DNS server)
- **C2 DNS Server**: 10.0.0.50 (Strela Stealer C2 DNS)
- **Delivery Server**: 172.16.0.25 (Malware delivery server)
- **External C2**: 203.0.113.10 (External command and control)
- **Backup C2**: 198.51.100.20 (Backup infrastructure)

#### Domain Infrastructure
- **Primary Domain**: detour-dog-malware.com
- **C2 Domain**: strela-stealer-campaign.net
- **Delivery Domain**: dns-malware-delivery.org
- **Infrastructure Domain**: detour-infrastructure.info

#### Subdomain Structure
- **Payload Delivery**: malware-payload.detour-dog-malware.com
- **C2 Communication**: strela-c2.strela-stealer-campaign.net
- **Data Exfiltration**: delivery.dns-malware-delivery.org

### Attack Flow Analysis

#### Phase 1: Initial Compromise
1. **DNS Server Compromise**: Attackers gain control of DNS infrastructure
2. **Domain Registration**: Malicious domains are registered and configured
3. **DNS Record Manipulation**: A records are modified to point to malicious servers
4. **DNS Cache Poisoning**: Legitimate DNS caches are compromised

#### Phase 2: Malware Delivery
1. **DNS Query Interception**: Legitimate DNS queries are intercepted
2. **Malicious Response**: DNS responses contain malware payloads
3. **Payload Execution**: Malware is executed on target systems
4. **Strela Stealer Installation**: Information stealer is deployed

#### Phase 3: Data Theft
1. **Credential Harvesting**: Browser and application credentials are extracted
2. **Cryptocurrency Theft**: Digital wallets are compromised
3. **Data Collection**: Sensitive information is gathered
4. **Data Exfiltration**: Stolen data is transmitted to C2 servers

#### Phase 4: Persistence
1. **Registry Modification**: Run keys are added for persistence
2. **Scheduled Task Creation**: Automated execution is established
3. **Service Installation**: Windows services are created
4. **DLL Hijacking**: Legitimate processes are compromised

## MITRE ATT&CK Framework Mapping

### Initial Access
- **T1566.001**: Spearphishing Attachment
- **T1566.002**: Spearphishing Link
- **T1189**: Drive-by Compromise

### Execution
- **T1059.001**: Command and Scripting Interpreter: PowerShell
- **T1059.003**: Command and Scripting Interpreter: Windows Command Shell
- **T1055.012**: Process Injection: Process Hollowing

### Persistence
- **T1547.001**: Boot or Logon Autostart Execution: Registry Run Keys
- **T1053.005**: Scheduled Task/Job: Scheduled Task
- **T1543.003**: Create or Modify System Process: Windows Service

### Defense Evasion
- **T1027**: Obfuscated Files or Information
- **T1055.012**: Process Injection: Process Hollowing
- **T1562.001**: Impair Defenses: Disable or Modify Tools

### Credential Access
- **T1555**: Credentials from Password Stores
- **T1003**: OS Credential Dumping
- **T1056.001**: Input Capture: Keylogging

### Discovery
- **T1083**: File and Directory Discovery
- **T1018**: Remote System Discovery
- **T1049**: System Network Connections Discovery

### Collection
- **T1005**: Data from Local System
- **T1560.001**: Archive Collected Data: Archive via Utility

### Command and Control
- **T1071.001**: Application Layer Protocol: Web Protocols
- **T1071.004**: Application Layer Protocol: DNS
- **T1105**: Ingress Tool Transfer

### Exfiltration
- **T1041**: Exfiltration Over C2 Channel
- **T1048.003**: Exfiltration Over Alternative Protocol: DNS
- **T1567.002**: Exfiltration Over Web Service: To Cloud Storage

## Detection Recommendations

### DNS Monitoring
- Monitor for connections to known C2 infrastructure
- Detect unusual DNS query patterns
- Monitor for DNS tunneling activities
- Check for DNS hijacking attempts

### Endpoint Detection
- Monitor for execution of known malware families
- Detect process injection activities
- Monitor for credential dumping activities
- Track scheduled task creation and modification

### Email Security
- Implement advanced phishing detection
- Monitor for spear-phishing campaigns
- Analyze email attachments for malicious content
- Deploy email security gateways with advanced threat protection

### Web Application Security
- Monitor for web shell uploads and execution
- Implement application-layer monitoring for suspicious activities
- Regular vulnerability assessments of public-facing applications
- Monitor for exploitation of web applications

## Mitigation Strategies

### Technical Controls
- Implement multi-factor authentication across all systems
- Regular patching of public-facing applications
- Network segmentation to limit lateral movement
- Endpoint detection and response (EDR) solutions
- Email security gateways with advanced threat protection
- Web application firewalls (WAF)

### Administrative Controls
- Security awareness training focusing on phishing recognition
- Regular security assessments and penetration testing
- Incident response planning and testing
- Vendor risk management for third-party applications
- Regular backup and recovery testing

### Monitoring and Detection
- 24/7 security operations center (SOC) monitoring
- Threat hunting activities focused on DNS-based attacks
- Regular IOC updates and threat intelligence integration
- Behavioral analytics for detecting advanced persistent threats
- Regular security assessments and vulnerability management

## Critical Vulnerabilities Exploited

### DNS Infrastructure Vulnerabilities
- **DNS Cache Poisoning**: Exploitation of DNS cache vulnerabilities
- **DNS Server Compromise**: Unauthorized access to DNS infrastructure
- **DNS Record Manipulation**: Modification of DNS records for malicious purposes
- **DNS Tunneling**: Abuse of DNS protocol for data exfiltration

### Endpoint Vulnerabilities
- **Process Injection**: Exploitation of process injection vulnerabilities
- **Registry Manipulation**: Unauthorized registry modifications
- **Service Installation**: Creation of malicious Windows services
- **DLL Hijacking**: Exploitation of DLL loading mechanisms

## MISP Event Details

### Event Information
- **Event ID**: [To be assigned by MISP instance]
- **Date**: 2025-01-15
- **Threat Level**: High (1)
- **TLP**: Amber
- **Attribute Count**: 35
- **Published**: False (for internal use)

### Attribute Categories
- **Network Activity**: 12 attributes (IP addresses, domains, URLs)
- **Payload Delivery**: 20 attributes (SHA256 hashes, MD5 hashes, filenames)
- **Persistence Mechanism**: 4 attributes (registry keys)
- **Attribution**: 3 attributes (threat actor names and malware families)

### Tags Applied
- `tlp:amber`
- `type:OSINT`
- `misp:threat-level="high"`
- `misp-galaxy:malware="Strela Stealer"`
- `misp-galaxy:malware="Detour Dog"`
- `misp-galaxy:malware="DNS Malware"`
- `misp-galaxy:tool="DNS Tunneling"`
- `misp-galaxy:tool="DNS Hijacking"`
- MITRE ATT&CK technique tags

## Key Indicators of Compromise (IOCs)

**Source**: [Infoblox Threat Intelligence Report](https://blogs.infoblox.com/threat-intelligence/detour-dog-dns-malware-powers-strela-stealer-campaigns/)

### Malicious Domains (C2 Infrastructure)
- cbox4.ignorelist[.]com
- claudfront[.]net
- allowlisted[.]net
- hsps[.]cc
- ads-tm-glb[.]click
- nsdps[.]cc
- j2update[.]cc

### Redirector Domains
- infosystemsllc[.]com (First Seen: August 1, 2024 | Last Seen: April 1, 2025)
- ecomicrolab[.]com (First Seen: December 8, 2024 | Last Seen: June 10, 2025)
- flow-distributor[.]com (First Seen: June 15, 2025 | Last Seen: July 15, 2025)
- advertipros[.]com (First Seen: June 10, 2025 | Last Seen: Current)

### Additional C2 Domains
- aeroarrows[.]io (First Seen: August 1, 2025 | Last Seen: August 6, 2025)
- airlogs[.]net (First Seen: April 23, 2024 | Last Seen: Current)
- cdn-routing[.]com (First Seen: July 8, 2024 | Last Seen: Current)
- webdmonitor[.]io (First Seen: October 7, 2024 | Last Seen: July 28, 2025)

**Note**: These domains have been identified as command and control (C2) servers utilized by the Detour Dog malware for Strela Stealer campaigns. The malware uses DNS for command and control communication, distinguishing it from other malware families.

### File Hashes (SHA256)
- bd636038676430aebb56469a6f9ca5e73c6289a82ea24b2d624dce542fe18338 (Detour Dog JavaScript malware)

### File Hashes (SHA-1)
- d1afdcd72522736f95544cc19e02b05a0abbff0f (Detour Dog JavaScript malware)

### File Hashes (MD5)
- 49080eb4286d5c013bc972238a602544 (Detour Dog JavaScript malware)

### Filenames
- bd636038676430aebb56469a6f9ca5e73c6289a82ea24b2d624dce542fe18338.js (Detour Dog JavaScript malware)

### Registry Keys
**Note**: Specific registry keys for persistence mechanisms are not provided in the available information from the Infoblox report.

## Conclusion

Detour Dog's DNS malware campaign represents a significant and evolving threat to organizations worldwide. The campaign's sophisticated use of DNS manipulation, malware delivery, and information theft requires comprehensive defense strategies. Organizations should implement multi-layered security controls, continuous monitoring, and regular security assessments to defend against such threats.

Immediate attention should be given to implementing DNS security solutions, endpoint detection and response, and user awareness training to protect against this advanced persistent threat.

## References

1. [Infoblox Detour Dog DNS Malware Report](https://blogs.infoblox.com/threat-intelligence/detour-dog-dns-malware-powers-strela-stealer-campaigns/)
2. [MITRE ATT&CK Framework](https://attack.mitre.org/)
3. [Strela Stealer Analysis](https://malpedia.caad.fkie.fraunhofer.de/details/win.strela)
4. [DNS Security Best Practices](https://www.ietf.org/rfc/rfc4033.txt)
5. [DNS Tunneling Detection](https://www.sans.org/white-papers/33212/)
6. [Information Stealer Malware](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-249a)

---

**Report Classification**: TLP:AMBER  
**Distribution**: Internal use only  
**Last Updated**: January 15, 2025  
**Next Review**: February 15, 2025  
**Report Version**: 1.0
